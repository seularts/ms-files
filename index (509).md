:::::::::::::: {.md-main role="main" md-component="main"}
::::::::::::: {.md-main__inner .md-grid}
:::::::: {.md-sidebar .md-sidebar--primary md-component="sidebar" md-type="navigation"}
::::::: md-sidebar__scrollwrap
:::::: md-sidebar__inner
[![logo](../assets/OWASP_Logo_Transp.png)](../index.html "OWASP Top 10:2021"){.md-nav__button
.md-logo aria-label="OWASP Top 10:2021" md-component="logo"} OWASP Top
10:2021

::::: md-nav__source
[](https://github.com/OWASP/Top10 "Go to repository"){.md-source
md-component="source"}

::: {.md-source__icon .md-icon}
![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdib3g9IjAgMCA0NDggNTEyIj48IS0tISBGb250IEF3ZXNvbWUgRnJlZSA2LjUuMSBieSBAZm9udGF3ZXNvbWUgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbSBMaWNlbnNlIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20vbGljZW5zZS9mcmVlIChJY29uczogQ0MgQlkgNC4wLCBGb250czogU0lMIE9GTCAxLjEsIENvZGU6IE1JVCBMaWNlbnNlKSBDb3B5cmlnaHQgMjAyMyBGb250aWNvbnMsIEluYy4tLT48cGF0aCBkPSJNNDM5LjU1IDIzNi4wNSAyNDQgNDAuNDVhMjguODcgMjguODcgMCAwIDAtNDAuODEgMGwtNDAuNjYgNDAuNjMgNTEuNTIgNTEuNTJjMjcuMDYtOS4xNCA1Mi42OCAxNi43NyA0My4zOSA0My42OGw0OS42NiA0OS42NmMzNC4yMy0xMS44IDYxLjE4IDMxIDM1LjQ3IDU2LjY5LTI2LjQ5IDI2LjQ5LTcwLjIxLTIuODctNTYtMzcuMzRMMjQwLjIyIDE5OXYxMjEuODVjMjUuMyAxMi41NCAyMi4yNiA0MS44NSA5LjA4IDU1YTM0LjM0IDM0LjM0IDAgMCAxLTQ4LjU1IDBjLTE3LjU3LTE3LjYtMTEuMDctNDYuOTEgMTEuMjUtNTZ2LTEyM2MtMjAuOC04LjUxLTI0LjYtMzAuNzQtMTguNjQtNDVMMTQyLjU3IDEwMSA4LjQ1IDIzNS4xNGEyOC44NiAyOC44NiAwIDAgMCAwIDQwLjgxbDE5NS42MSAxOTUuNmEyOC44NiAyOC44NiAwIDAgMCA0MC44IDBsMTk0LjY5LTE5NC42OWEyOC44NiAyOC44NiAwIDAgMCAwLTQwLjgxeiIgLz48L3N2Zz4=)
:::

::: md-source__repository
OWASP/Top10
:::
:::::

[[ Home ]{.md-ellipsis}](../index.html){.md-nav__link}

[[ Notice ]{.md-ellipsis}](../0x00-notice/index.html){.md-nav__link}

[[ Introduction
]{.md-ellipsis}](../A00_2021_Introduction/index.html){.md-nav__link}

[[ How to use the OWASP Top 10 as a standard
]{.md-ellipsis}](../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/index.html){.md-nav__link}

[[ How to start an AppSec program with the OWASP Top 10
]{.md-ellipsis}](../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/index.html){.md-nav__link}

[[ About OWASP
]{.md-ellipsis}](../A00-about-owasp/index.html){.md-nav__link}

[ Top 10:2021 List ]{.md-ellipsis} []{.md-nav__icon .md-icon}

[]{.md-nav__icon .md-icon} Top 10:2021 List

[[ A01 Broken Access Control
]{.md-ellipsis}](../A01_2021-Broken_Access_Control/index.html){.md-nav__link}

[[ A02 Cryptographic Failures
]{.md-ellipsis}](../A02_2021-Cryptographic_Failures/index.html){.md-nav__link}

[[ A03 Injection
]{.md-ellipsis}](../A03_2021-Injection/index.html){.md-nav__link}

[[ A04 Insecure Design
]{.md-ellipsis}](../A04_2021-Insecure_Design/index.html){.md-nav__link}

[[ A05 Security Misconfiguration
]{.md-ellipsis}](../A05_2021-Security_Misconfiguration/index.html){.md-nav__link}

[[ A06 Vulnerable and Outdated Components
]{.md-ellipsis}](../A06_2021-Vulnerable_and_Outdated_Components/index.html){.md-nav__link}

[ A07 Identification and Authentication Failures ]{.md-ellipsis}
[]{.md-nav__icon .md-icon} [[ A07 Identification and Authentication
Failures ]{.md-ellipsis}](index.html){.md-nav__link
.md-nav__link--active}

[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}

[[ A08 Software and Data Integrity Failures
]{.md-ellipsis}](../A08_2021-Software_and_Data_Integrity_Failures/index.html){.md-nav__link}

[[ A09 Security Logging and Monitoring Failures
]{.md-ellipsis}](../A09_2021-Security_Logging_and_Monitoring_Failures/index.html){.md-nav__link}

[[ A10 Server Side Request Forgery (SSRF)
]{.md-ellipsis}](../A10_2021-Server-Side_Request_Forgery_(SSRF)/index.html){.md-nav__link}

[[ Next Steps
]{.md-ellipsis}](../A11_2021-Next_Steps/index.html){.md-nav__link}
::::::
:::::::
::::::::

::::: {.md-sidebar .md-sidebar--secondary md-component="sidebar" md-type="toc"}
:::: md-sidebar__scrollwrap
::: md-sidebar__inner
[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}
:::
::::
:::::

::: {.md-content md-component="content"}
# A07:2021 -- Identification and Authentication Failures ![icon](../assets/TOP_10_Icons_Final_Identification_and_Authentication_Failures.png){align="right" style="height:80px;width:80px"} {#a072021-identification-and-authentication-failures}

## Factors

   CWEs Mapped   Max Incidence Rate   Avg Incidence Rate   Avg Weighted Exploit   Avg Weighted Impact   Max Coverage   Avg Coverage   Total Occurrences   Total CVEs
  ------------- -------------------- -------------------- ---------------------- --------------------- -------------- -------------- ------------------- ------------
       22              14.84%               2.55%                  7.40                  6.50              79.51%         45.72%           132,195          3,897

## Overview

Previously known as *Broken Authentication*, this category slid down
from the second position and now includes Common Weakness Enumerations
(CWEs) related to identification failures. Notable CWEs included are
*CWE-297: Improper Validation of Certificate with Host Mismatch*,
*CWE-287: Improper Authentication*, and *CWE-384: Session Fixation*.

## Description

Confirmation of the user\'s identity, authentication, and session
management is critical to protect against authentication-related
attacks. There may be authentication weaknesses if the application:

- Permits automated attacks such as credential stuffing, where the
  attacker has a list of valid usernames and passwords.

- Permits brute force or other automated attacks.

- Permits default, weak, or well-known passwords, such as \"Password1\"
  or \"admin/admin\".

- Uses weak or ineffective credential recovery and forgot-password
  processes, such as \"knowledge-based answers,\" which cannot be made
  safe.

- Uses plain text, encrypted, or weakly hashed passwords data stores
  (see [A02:2021-Cryptographic
  Failures](../A02_2021-Cryptographic_Failures/index.html)).

- Has missing or ineffective multi-factor authentication.

- Exposes session identifier in the URL.

- Reuse session identifier after successful login.

- Does not correctly invalidate Session IDs. User sessions or
  authentication tokens (mainly single sign-on (SSO) tokens) aren\'t
  properly invalidated during logout or a period of inactivity.

## How to Prevent

- Where possible, implement multi-factor authentication to prevent
  automated credential stuffing, brute force, and stolen credential
  reuse attacks.

- Do not ship or deploy with any default credentials, particularly for
  admin users.

- Implement weak password checks, such as testing new or changed
  passwords against the top 10,000 worst passwords list.

- Align password length, complexity, and rotation policies with National
  Institute of Standards and Technology (NIST) 800-63b\'s guidelines in
  section 5.1.1 for Memorized Secrets or other modern, evidence-based
  password policies.

- Ensure registration, credential recovery, and API pathways are
  hardened against account enumeration attacks by using the same
  messages for all outcomes.

- Limit or increasingly delay failed login attempts, but be careful not
  to create a denial of service scenario. Log all failures and alert
  administrators when credential stuffing, brute force, or other attacks
  are detected.

- Use a server-side, secure, built-in session manager that generates a
  new random session ID with high entropy after login. Session
  identifier should not be in the URL, be securely stored, and
  invalidated after logout, idle, and absolute timeouts.

## Example Attack Scenarios

**Scenario #1:** Credential stuffing, the use of lists of known
passwords, is a common attack. Suppose an application does not implement
automated threat or credential stuffing protection. In that case, the
application can be used as a password oracle to determine if the
credentials are valid.

**Scenario #2:** Most authentication attacks occur due to the continued
use of passwords as a sole factor. Once considered best practices,
password rotation and complexity requirements encourage users to use and
reuse weak passwords. Organizations are recommended to stop these
practices per NIST 800-63 and use multi-factor authentication.

**Scenario #3:** Application session timeouts aren\'t set correctly. A
user uses a public computer to access an application. Instead of
selecting \"logout,\" the user simply closes the browser tab and walks
away. An attacker uses the same browser an hour later, and the user is
still authenticated.

## References

- [OWASP Proactive Controls: Implement Digital
  Identity](http://top10proactive.owasp.org/v3/en/c6-digital-identity)

- [OWASP Application Security Verification Standard: V2
  authentication](../../www-project-application-security-verification-standard/index.html)

- [OWASP Application Security Verification Standard: V3 Session
  Management](../../www-project-application-security-verification-standard/index.html)

- [OWASP Testing Guide:
  Identity](../../www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/03-Identity_Management_Testing/README.html),Â [Authentication](../../www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/04-Authentication_Testing/README.html)

- [OWASP Cheat Sheet:
  Authentication](https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html)

- [OWASP Cheat Sheet: Credential
  Stuffing](https://cheatsheetseries.owasp.org/cheatsheets/Credential_Stuffing_Prevention_Cheat_Sheet.html)

- [OWASP Cheat Sheet: Forgot
  Password](https://cheatsheetseries.owasp.org/cheatsheets/Forgot_Password_Cheat_Sheet.html)

- [OWASP Cheat Sheet: Session
  Management](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)

- [OWASP Automated Threats
  Handbook](../../www-project-automated-threats-to-web-applications/index.html)

- [NIST 800-63b: 5.1.1 Memorized
  Secrets](https://pages.nist.gov/800-63-3/sp800-63b.html#memsecret)

## List of Mapped CWEs

[CWE-255 Credentials Management
Errors](https://cwe.mitre.org/data/definitions/255.html)

[CWE-259 Use of Hard-coded
Password](https://cwe.mitre.org/data/definitions/259.html)

[CWE-287 Improper
Authentication](https://cwe.mitre.org/data/definitions/287.html)

[CWE-288 Authentication Bypass Using an Alternate Path or
Channel](https://cwe.mitre.org/data/definitions/288.html)

[CWE-290 Authentication Bypass by
Spoofing](https://cwe.mitre.org/data/definitions/290.html)

[CWE-294 Authentication Bypass by
Capture-replay](https://cwe.mitre.org/data/definitions/294.html)

[CWE-295 Improper Certificate
Validation](https://cwe.mitre.org/data/definitions/295.html)

[CWE-297 Improper Validation of Certificate with Host
Mismatch](https://cwe.mitre.org/data/definitions/297.html)

[CWE-300 Channel Accessible by
Non-Endpoint](https://cwe.mitre.org/data/definitions/300.html)

[CWE-302 Authentication Bypass by Assumed-Immutable
Data](https://cwe.mitre.org/data/definitions/302.html)

[CWE-304 Missing Critical Step in
Authentication](https://cwe.mitre.org/data/definitions/304.html)

[CWE-306 Missing Authentication for Critical
Function](https://cwe.mitre.org/data/definitions/306.html)

[CWE-307 Improper Restriction of Excessive Authentication
Attempts](https://cwe.mitre.org/data/definitions/307.html)

[CWE-346 Origin Validation
Error](https://cwe.mitre.org/data/definitions/346.html)

[CWE-384 Session
Fixation](https://cwe.mitre.org/data/definitions/384.html)

[CWE-521 Weak Password
Requirements](https://cwe.mitre.org/data/definitions/521.html)

[CWE-613 Insufficient Session
Expiration](https://cwe.mitre.org/data/definitions/613.html)

[CWE-620 Unverified Password
Change](https://cwe.mitre.org/data/definitions/620.html)

[CWE-640 Weak Password Recovery Mechanism for Forgotten
Password](https://cwe.mitre.org/data/definitions/640.html)

[CWE-798 Use of Hard-coded
Credentials](https://cwe.mitre.org/data/definitions/798.html)

[CWE-940 Improper Verification of Source of a Communication
Channel](https://cwe.mitre.org/data/definitions/940.html)

[CWE-1216 Lockout Mechanism
Errors](https://cwe.mitre.org/data/definitions/1216.html)
:::
:::::::::::::
::::::::::::::
