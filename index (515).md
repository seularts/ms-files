:::::::::::::: {.md-main role="main" md-component="main"}
::::::::::::: {.md-main__inner .md-grid}
:::::::: {.md-sidebar .md-sidebar--primary md-component="sidebar" md-type="navigation"}
::::::: md-sidebar__scrollwrap
:::::: md-sidebar__inner
[![logo](../assets/OWASP_Logo_Transp.png)](../index.html "OWASP Top 10:2021"){.md-nav__button
.md-logo aria-label="OWASP Top 10:2021" md-component="logo"} OWASP Top
10:2021

::::: md-nav__source
[](https://github.com/OWASP/Top10 "Go to repository"){.md-source
md-component="source"}

::: {.md-source__icon .md-icon}
![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdib3g9IjAgMCA0NDggNTEyIj48IS0tISBGb250IEF3ZXNvbWUgRnJlZSA2LjUuMSBieSBAZm9udGF3ZXNvbWUgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbSBMaWNlbnNlIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20vbGljZW5zZS9mcmVlIChJY29uczogQ0MgQlkgNC4wLCBGb250czogU0lMIE9GTCAxLjEsIENvZGU6IE1JVCBMaWNlbnNlKSBDb3B5cmlnaHQgMjAyMyBGb250aWNvbnMsIEluYy4tLT48cGF0aCBkPSJNNDM5LjU1IDIzNi4wNSAyNDQgNDAuNDVhMjguODcgMjguODcgMCAwIDAtNDAuODEgMGwtNDAuNjYgNDAuNjMgNTEuNTIgNTEuNTJjMjcuMDYtOS4xNCA1Mi42OCAxNi43NyA0My4zOSA0My42OGw0OS42NiA0OS42NmMzNC4yMy0xMS44IDYxLjE4IDMxIDM1LjQ3IDU2LjY5LTI2LjQ5IDI2LjQ5LTcwLjIxLTIuODctNTYtMzcuMzRMMjQwLjIyIDE5OXYxMjEuODVjMjUuMyAxMi41NCAyMi4yNiA0MS44NSA5LjA4IDU1YTM0LjM0IDM0LjM0IDAgMCAxLTQ4LjU1IDBjLTE3LjU3LTE3LjYtMTEuMDctNDYuOTEgMTEuMjUtNTZ2LTEyM2MtMjAuOC04LjUxLTI0LjYtMzAuNzQtMTguNjQtNDVMMTQyLjU3IDEwMSA4LjQ1IDIzNS4xNGEyOC44NiAyOC44NiAwIDAgMCAwIDQwLjgxbDE5NS42MSAxOTUuNmEyOC44NiAyOC44NiAwIDAgMCA0MC44IDBsMTk0LjY5LTE5NC42OWEyOC44NiAyOC44NiAwIDAgMCAwLTQwLjgxeiIgLz48L3N2Zz4=)
:::

::: md-source__repository
OWASP/Top10
:::
:::::

[[ Home ]{.md-ellipsis}](../index.html){.md-nav__link}

[[ Notice ]{.md-ellipsis}](../0x00-notice/index.html){.md-nav__link}

[[ Introduction
]{.md-ellipsis}](../A00_2021_Introduction/index.html){.md-nav__link}

[[ How to use the OWASP Top 10 as a standard
]{.md-ellipsis}](../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/index.html){.md-nav__link}

[[ How to start an AppSec program with the OWASP Top 10
]{.md-ellipsis}](../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/index.html){.md-nav__link}

[[ About OWASP
]{.md-ellipsis}](../A00-about-owasp/index.html){.md-nav__link}

[ Top 10:2021 List ]{.md-ellipsis} []{.md-nav__icon .md-icon}

[]{.md-nav__icon .md-icon} Top 10:2021 List

[ A01 Broken Access Control ]{.md-ellipsis} []{.md-nav__icon .md-icon}
[[ A01 Broken Access Control ]{.md-ellipsis}](index.html){.md-nav__link
.md-nav__link--active}

[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}

[[ A02 Cryptographic Failures
]{.md-ellipsis}](../A02_2021-Cryptographic_Failures/index.html){.md-nav__link}

[[ A03 Injection
]{.md-ellipsis}](../A03_2021-Injection/index.html){.md-nav__link}

[[ A04 Insecure Design
]{.md-ellipsis}](../A04_2021-Insecure_Design/index.html){.md-nav__link}

[[ A05 Security Misconfiguration
]{.md-ellipsis}](../A05_2021-Security_Misconfiguration/index.html){.md-nav__link}

[[ A06 Vulnerable and Outdated Components
]{.md-ellipsis}](../A06_2021-Vulnerable_and_Outdated_Components/index.html){.md-nav__link}

[[ A07 Identification and Authentication Failures
]{.md-ellipsis}](../A07_2021-Identification_and_Authentication_Failures/index.html){.md-nav__link}

[[ A08 Software and Data Integrity Failures
]{.md-ellipsis}](../A08_2021-Software_and_Data_Integrity_Failures/index.html){.md-nav__link}

[[ A09 Security Logging and Monitoring Failures
]{.md-ellipsis}](../A09_2021-Security_Logging_and_Monitoring_Failures/index.html){.md-nav__link}

[[ A10 Server Side Request Forgery (SSRF)
]{.md-ellipsis}](../A10_2021-Server-Side_Request_Forgery_(SSRF)/index.html){.md-nav__link}

[[ Next Steps
]{.md-ellipsis}](../A11_2021-Next_Steps/index.html){.md-nav__link}
::::::
:::::::
::::::::

::::: {.md-sidebar .md-sidebar--secondary md-component="sidebar" md-type="toc"}
:::: md-sidebar__scrollwrap
::: md-sidebar__inner
[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}
:::
::::
:::::

::: {.md-content md-component="content"}
# A01:2021 -- Broken Access Control ![icon](../assets/TOP_10_Icons_Final_Broken_Access_Control.png){align="right" style="height:80px;width:80px"} {#a012021-broken-access-control}

## Factors

   CWEs Mapped   Max Incidence Rate   Avg Incidence Rate   Avg Weighted Exploit   Avg Weighted Impact   Max Coverage   Avg Coverage   Total Occurrences   Total CVEs
  ------------- -------------------- -------------------- ---------------------- --------------------- -------------- -------------- ------------------- ------------
       34              55.97%               3.81%                  6.92                  5.93              94.55%         47.72%           318,487          19,013

## Overview

Moving up from the fifth position, 94% of applications were tested for
some form of broken access control with the average incidence rate of
3.81%, and has the most occurrences in the contributed dataset with over
318k. Notable Common Weakness Enumerations (CWEs) included are *CWE-200:
Exposure of Sensitive Information to an Unauthorized Actor*, *CWE-201:
Insertion of Sensitive Information Into Sent Data*, and *CWE-352:
Cross-Site Request Forgery*.

## Description

Access control enforces policy such that users cannot act outside of
their intended permissions. Failures typically lead to unauthorized
information disclosure, modification, or destruction of all data or
performing a business function outside the user\'s limits. Common access
control vulnerabilities include:

- Violation of the principle of least privilege or deny by default,
  where access should only be granted for particular capabilities,
  roles, or users, but is available to anyone.

- Bypassing access control checks by modifying the URL (parameter
  tampering or force browsing), internal application state, or the HTML
  page, or by using an attack tool modifying API requests.

- Permitting viewing or editing someone else\'s account, by providing
  its unique identifier (insecure direct object references)

- Accessing API with missing access controls for POST, PUT and DELETE.

- Elevation of privilege. Acting as a user without being logged in or
  acting as an admin when logged in as a user.

- Metadata manipulation, such as replaying or tampering with a JSON Web
  Token (JWT) access control token, or a cookie or hidden field
  manipulated to elevate privileges or abusing JWT invalidation.

- CORS misconfiguration allows API access from unauthorized/untrusted
  origins.

- Force browsing to authenticated pages as an unauthenticated user or to
  privileged pages as a standard user.

## How to Prevent

Access control is only effective in trusted server-side code or
server-less API, where the attacker cannot modify the access control
check or metadata.

- Except for public resources, deny by default.

- Implement access control mechanisms once and re-use them throughout
  the application, including minimizing Cross-Origin Resource Sharing
  (CORS) usage.

- Model access controls should enforce record ownership rather than
  accepting that the user can create, read, update, or delete any
  record.

- Unique application business limit requirements should be enforced by
  domain models.

- Disable web server directory listing and ensure file metadata (e.g.,
  .git) and backup files are not present within web roots.

- Log access control failures, alert admins when appropriate (e.g.,
  repeated failures).

- Rate limit API and controller access to minimize the harm from
  automated attack tooling.

- Stateful session identifiers should be invalidated on the server after
  logout. Stateless JWT tokens should rather be short-lived so that the
  window of opportunity for an attacker is minimized. For longer lived
  JWTs it\'s highly recommended to follow the OAuth standards to revoke
  access.

Developers and QA staff should include functional access control unit
and integration tests.

## Example Attack Scenarios

**Scenario #1:** The application uses unverified data in a SQL call that
is accessing account information:

     pstmt.setString(1, request.getParameter("acct"));
     ResultSet results = pstmt.executeQuery( );

An attacker simply modifies the browser\'s \'acct\' parameter to send
whatever account number they want. If not correctly verified, the
attacker can access any user\'s account.

     https://example.com/app/accountInfo?acct=notmyacct

**Scenario #2:** An attacker simply forces browses to target URLs. Admin
rights are required for access to the admin page.

     https://example.com/app/getappInfo
     https://example.com/app/admin_getappInfo

If an unauthenticated user can access either page, it\'s a flaw. If a
non-admin can access the admin page, this is a flaw.

## References

- [OWASP Proactive Controls: Enforce Access
  Controls](http://top10proactive.owasp.org/v3/en/c7-enforce-access-controls)

- [OWASP Application Security Verification Standard: V4 Access
  Control](../../www-project-application-security-verification-standard/index.html)

- [OWASP Testing Guide: Authorization
  Testing](../../www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/README.html)

- [OWASP Cheat Sheet:
  Authorization](https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html)

- [PortSwigger: Exploiting CORS
  misconfiguration](https://portswigger.net/blog/exploiting-cors-misconfigurations-for-bitcoins-and-bounties)

- [OAuth: Revoking
  Access](https://www.oauth.com/oauth2-servers/listing-authorizations/revoking-access/)

## List of Mapped CWEs

[CWE-22 Improper Limitation of a Pathname to a Restricted Directory
(\'Path Traversal\')](https://cwe.mitre.org/data/definitions/22.html)

[CWE-23 Relative Path
Traversal](https://cwe.mitre.org/data/definitions/23.html)

[CWE-35 Path Traversal:
\'\.../\...//\'](https://cwe.mitre.org/data/definitions/35.html)

[CWE-59 Improper Link Resolution Before File Access (\'Link
Following\')](https://cwe.mitre.org/data/definitions/59.html)

[CWE-200 Exposure of Sensitive Information to an Unauthorized
Actor](https://cwe.mitre.org/data/definitions/200.html)

[CWE-201 Exposure of Sensitive Information Through Sent
Data](https://cwe.mitre.org/data/definitions/201.html)

[CWE-219 Storage of File with Sensitive Data Under Web
Root](https://cwe.mitre.org/data/definitions/219.html)

[CWE-264 Permissions, Privileges, and Access Controls (should no longer
be used)](https://cwe.mitre.org/data/definitions/264.html)

[CWE-275 Permission
Issues](https://cwe.mitre.org/data/definitions/275.html)

[CWE-276 Incorrect Default
Permissions](https://cwe.mitre.org/data/definitions/276.html)

[CWE-284 Improper Access
Control](https://cwe.mitre.org/data/definitions/284.html)

[CWE-285 Improper
Authorization](https://cwe.mitre.org/data/definitions/285.html)

[CWE-352 Cross-Site Request Forgery
(CSRF)](https://cwe.mitre.org/data/definitions/352.html)

[CWE-359 Exposure of Private Personal Information to an Unauthorized
Actor](https://cwe.mitre.org/data/definitions/359.html)

[CWE-377 Insecure Temporary
File](https://cwe.mitre.org/data/definitions/377.html)

[CWE-402 Transmission of Private Resources into a New Sphere (\'Resource
Leak\')](https://cwe.mitre.org/data/definitions/402.html)

[CWE-425 Direct Request (\'Forced
Browsing\')](https://cwe.mitre.org/data/definitions/425.html)

[CWE-441 Unintended Proxy or Intermediary (\'Confused
Deputy\')](https://cwe.mitre.org/data/definitions/441.html)

[CWE-497 Exposure of Sensitive System Information to an Unauthorized
Control Sphere](https://cwe.mitre.org/data/definitions/497.html)

[CWE-538 Insertion of Sensitive Information into Externally-Accessible
File or Directory](https://cwe.mitre.org/data/definitions/538.html)

[CWE-540 Inclusion of Sensitive Information in Source
Code](https://cwe.mitre.org/data/definitions/540.html)

[CWE-548 Exposure of Information Through Directory
Listing](https://cwe.mitre.org/data/definitions/548.html)

[CWE-552 Files or Directories Accessible to External
Parties](https://cwe.mitre.org/data/definitions/552.html)

[CWE-566 Authorization Bypass Through User-Controlled SQL Primary
Key](https://cwe.mitre.org/data/definitions/566.html)

[CWE-601 URL Redirection to Untrusted Site (\'Open
Redirect\')](https://cwe.mitre.org/data/definitions/601.html)

[CWE-639 Authorization Bypass Through User-Controlled
Key](https://cwe.mitre.org/data/definitions/639.html)

[CWE-651 Exposure of WSDL File Containing Sensitive
Information](https://cwe.mitre.org/data/definitions/651.html)

[CWE-668 Exposure of Resource to Wrong
Sphere](https://cwe.mitre.org/data/definitions/668.html)

[CWE-706 Use of Incorrectly-Resolved Name or
Reference](https://cwe.mitre.org/data/definitions/706.html)

[CWE-862 Missing
Authorization](https://cwe.mitre.org/data/definitions/862.html)

[CWE-863 Incorrect
Authorization](https://cwe.mitre.org/data/definitions/863.html)

[CWE-913 Improper Control of Dynamically-Managed Code
Resources](https://cwe.mitre.org/data/definitions/913.html)

[CWE-922 Insecure Storage of Sensitive
Information](https://cwe.mitre.org/data/definitions/922.html)

[CWE-1275 Sensitive Cookie with Improper SameSite
Attribute](https://cwe.mitre.org/data/definitions/1275.html)
:::
:::::::::::::
::::::::::::::
