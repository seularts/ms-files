:::::::::::::: {.md-main role="main" md-component="main"}
::::::::::::: {.md-main__inner .md-grid}
:::::::: {.md-sidebar .md-sidebar--primary md-component="sidebar" md-type="navigation"}
::::::: md-sidebar__scrollwrap
:::::: md-sidebar__inner
[![logo](../assets/OWASP_Logo_Transp.png)](../index.html "OWASP Top 10:2021"){.md-nav__button
.md-logo aria-label="OWASP Top 10:2021" md-component="logo"} OWASP Top
10:2021

::::: md-nav__source
[](https://github.com/OWASP/Top10 "Go to repository"){.md-source
md-component="source"}

::: {.md-source__icon .md-icon}
![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdib3g9IjAgMCA0NDggNTEyIj48IS0tISBGb250IEF3ZXNvbWUgRnJlZSA2LjUuMSBieSBAZm9udGF3ZXNvbWUgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbSBMaWNlbnNlIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20vbGljZW5zZS9mcmVlIChJY29uczogQ0MgQlkgNC4wLCBGb250czogU0lMIE9GTCAxLjEsIENvZGU6IE1JVCBMaWNlbnNlKSBDb3B5cmlnaHQgMjAyMyBGb250aWNvbnMsIEluYy4tLT48cGF0aCBkPSJNNDM5LjU1IDIzNi4wNSAyNDQgNDAuNDVhMjguODcgMjguODcgMCAwIDAtNDAuODEgMGwtNDAuNjYgNDAuNjMgNTEuNTIgNTEuNTJjMjcuMDYtOS4xNCA1Mi42OCAxNi43NyA0My4zOSA0My42OGw0OS42NiA0OS42NmMzNC4yMy0xMS44IDYxLjE4IDMxIDM1LjQ3IDU2LjY5LTI2LjQ5IDI2LjQ5LTcwLjIxLTIuODctNTYtMzcuMzRMMjQwLjIyIDE5OXYxMjEuODVjMjUuMyAxMi41NCAyMi4yNiA0MS44NSA5LjA4IDU1YTM0LjM0IDM0LjM0IDAgMCAxLTQ4LjU1IDBjLTE3LjU3LTE3LjYtMTEuMDctNDYuOTEgMTEuMjUtNTZ2LTEyM2MtMjAuOC04LjUxLTI0LjYtMzAuNzQtMTguNjQtNDVMMTQyLjU3IDEwMSA4LjQ1IDIzNS4xNGEyOC44NiAyOC44NiAwIDAgMCAwIDQwLjgxbDE5NS42MSAxOTUuNmEyOC44NiAyOC44NiAwIDAgMCA0MC44IDBsMTk0LjY5LTE5NC42OWEyOC44NiAyOC44NiAwIDAgMCAwLTQwLjgxeiIgLz48L3N2Zz4=)
:::

::: md-source__repository
OWASP/Top10
:::
:::::

[[ Home ]{.md-ellipsis}](../index.html){.md-nav__link}

[[ Notice ]{.md-ellipsis}](../0x00-notice/index.html){.md-nav__link}

[[ Introduction
]{.md-ellipsis}](../A00_2021_Introduction/index.html){.md-nav__link}

[[ How to use the OWASP Top 10 as a standard
]{.md-ellipsis}](../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/index.html){.md-nav__link}

[[ How to start an AppSec program with the OWASP Top 10
]{.md-ellipsis}](../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/index.html){.md-nav__link}

[[ About OWASP
]{.md-ellipsis}](../A00-about-owasp/index.html){.md-nav__link}

[ Top 10:2021 List ]{.md-ellipsis} []{.md-nav__icon .md-icon}

[]{.md-nav__icon .md-icon} Top 10:2021 List

[[ A01 Broken Access Control
]{.md-ellipsis}](../A01_2021-Broken_Access_Control/index.html){.md-nav__link}

[[ A02 Cryptographic Failures
]{.md-ellipsis}](../A02_2021-Cryptographic_Failures/index.html){.md-nav__link}

[[ A03 Injection
]{.md-ellipsis}](../A03_2021-Injection/index.html){.md-nav__link}

[[ A04 Insecure Design
]{.md-ellipsis}](../A04_2021-Insecure_Design/index.html){.md-nav__link}

[[ A05 Security Misconfiguration
]{.md-ellipsis}](../A05_2021-Security_Misconfiguration/index.html){.md-nav__link}

[[ A06 Vulnerable and Outdated Components
]{.md-ellipsis}](../A06_2021-Vulnerable_and_Outdated_Components/index.html){.md-nav__link}

[[ A07 Identification and Authentication Failures
]{.md-ellipsis}](../A07_2021-Identification_and_Authentication_Failures/index.html){.md-nav__link}

[[ A08 Software and Data Integrity Failures
]{.md-ellipsis}](../A08_2021-Software_and_Data_Integrity_Failures/index.html){.md-nav__link}

[[ A09 Security Logging and Monitoring Failures
]{.md-ellipsis}](../A09_2021-Security_Logging_and_Monitoring_Failures/index.html){.md-nav__link}

[ A10 Server Side Request Forgery (SSRF) ]{.md-ellipsis}
[]{.md-nav__icon .md-icon} [[ A10 Server Side Request Forgery (SSRF)
]{.md-ellipsis}](index.html){.md-nav__link .md-nav__link--active}

[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
  - [[ From Network layer
    ]{.md-ellipsis}](#from-network-layer){.md-nav__link}
  - [[ From Application layer:
    ]{.md-ellipsis}](#from-application-layer){.md-nav__link}
  - [[ Additional Measures to consider:
    ]{.md-ellipsis}](#additional-measures-to-consider){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}

[[ Next Steps
]{.md-ellipsis}](../A11_2021-Next_Steps/index.html){.md-nav__link}
::::::
:::::::
::::::::

::::: {.md-sidebar .md-sidebar--secondary md-component="sidebar" md-type="toc"}
:::: md-sidebar__scrollwrap
::: md-sidebar__inner
[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
  - [[ From Network layer
    ]{.md-ellipsis}](#from-network-layer){.md-nav__link}
  - [[ From Application layer:
    ]{.md-ellipsis}](#from-application-layer){.md-nav__link}
  - [[ Additional Measures to consider:
    ]{.md-ellipsis}](#additional-measures-to-consider){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}
:::
::::
:::::

::: {.md-content md-component="content"}
# A10:2021 -- Server-Side Request Forgery (SSRF) ![icon](../assets/TOP_10_Icons_Final_SSRF.png){align="right" style="height:80px;width:80px"} {#a102021-server-side-request-forgery-ssrf}

## Factors

   CWEs Mapped   Max Incidence Rate   Avg Incidence Rate   Avg Weighted Exploit   Avg Weighted Impact   Max Coverage   Avg Coverage   Total Occurrences   Total CVEs
  ------------- -------------------- -------------------- ---------------------- --------------------- -------------- -------------- ------------------- ------------
        1              2.72%                2.72%                  8.28                  6.72              67.72%         67.72%            9,503            385

## Overview

This category is added from the Top 10 community survey (#1). The data
shows a relatively low incidence rate with above average testing
coverage and above-average Exploit and Impact potential ratings. As new
entries are likely to be a single or small cluster of Common Weakness
Enumerations (CWEs) for attention and awareness, the hope is that they
are subject to focus and can be rolled into a larger category in a
future edition.

## Description

SSRF flaws occur whenever a web application is fetching a remote
resource without validating the user-supplied URL. It allows an attacker
to coerce the application to send a crafted request to an unexpected
destination, even when protected by a firewall, VPN, or another type of
network access control list (ACL).

As modern web applications provide end-users with convenient features,
fetching a URL becomes a common scenario. As a result, the incidence of
SSRF is increasing. Also, the severity of SSRF is becoming higher due to
cloud services and the complexity of architectures.

## How to Prevent

Developers can prevent SSRF by implementing some or all the following
defense in depth controls:

### **From Network layer**

- Segment remote resource access functionality in separate networks to
  reduce the impact of SSRF

- Enforce "deny by default" firewall policies or network access control
  rules to block all but essential intranet traffic.\
  *Hints:*\
  \~ Establish an ownership and a lifecycle for firewall rules based on
  applications.\
  \~ Log all accepted *and* blocked network flows on firewalls (see
  [A09:2021-Security Logging and Monitoring
  Failures](../A09_2021-Security_Logging_and_Monitoring_Failures/index.html)).

### **From Application layer:**

- Sanitize and validate all client-supplied input data

- Enforce the URL schema, port, and destination with a positive allow
  list

- Do not send raw responses to clients

- Disable HTTP redirections

- Be aware of the URL consistency to avoid attacks such as DNS rebinding
  and "time of check, time of use" (TOCTOU) race conditions

Do not mitigate SSRF via the use of a deny list or regular expression.
Attackers have payload lists, tools, and skills to bypass deny lists.

### **Additional Measures to consider:**

- Don\'t deploy other security relevant services on front systems (e.g.
  OpenID). Control local traffic on these systems (e.g. localhost)

- For frontends with dedicated and manageable user groups use network
  encryption (e.g. VPNs) on independent systems to consider very high
  protection needs

## Example Attack Scenarios

Attackers can use SSRF to attack systems protected behind web
application firewalls, firewalls, or network ACLs, using scenarios such
as:

**Scenario #1:** Port scan internal servers -- If the network
architecture is unsegmented, attackers can map out internal networks and
determine if ports are open or closed on internal servers from
connection results or elapsed time to connect or reject SSRF payload
connections.

**Scenario #2:** Sensitive data exposure -- Attackers can access local
files or internal services to gain sensitive information such as
`file:///etc/passwd` and `http://localhost:28017/`.

**Scenario #3:** Access metadata storage of cloud services -- Most cloud
providers have metadata storage such as `http://169.254.169.254/`. An
attacker can read the metadata to gain sensitive information.

**Scenario #4:** Compromise internal services -- The attacker can abuse
internal services to conduct further attacks such as Remote Code
Execution (RCE) or Denial of Service (DoS).

## References

- [OWASP - Server-Side Request Forgery Prevention Cheat
  Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html)

- [PortSwigger - Server-side request forgery
  (SSRF)](https://portswigger.net/web-security/ssrf)

- [Acunetix - What is Server-Side Request Forgery
  (SSRF)?](https://www.acunetix.com/blog/articles/server-side-request-forgery-vulnerability/)

- [SSRF
  bible](https://cheatsheetseries.owasp.org/assets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet_SSRF_Bible.pdf)

- [A New Era of SSRF - Exploiting URL Parser in Trending Programming
  Languages!](https://www.blackhat.com/docs/us-17/thursday/us-17-Tsai-A-New-Era-Of-SSRF-Exploiting-URL-Parser-In-Trending-Programming-Languages.pdf)

## List of Mapped CWEs

[CWE-918 Server-Side Request Forgery
(SSRF)](https://cwe.mitre.org/data/definitions/918.html)
:::
:::::::::::::
::::::::::::::
