:::::::::::::: {.md-main role="main" md-component="main"}
::::::::::::: {.md-main__inner .md-grid}
:::::::: {.md-sidebar .md-sidebar--primary md-component="sidebar" md-type="navigation"}
::::::: md-sidebar__scrollwrap
:::::: md-sidebar__inner
[![logo](../assets/OWASP_Logo_Transp.png)](../index.html "OWASP Top 10:2021"){.md-nav__button
.md-logo aria-label="OWASP Top 10:2021" md-component="logo"} OWASP Top
10:2021

::::: md-nav__source
[](https://github.com/OWASP/Top10 "Go to repository"){.md-source
md-component="source"}

::: {.md-source__icon .md-icon}
![](data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdib3g9IjAgMCA0NDggNTEyIj48IS0tISBGb250IEF3ZXNvbWUgRnJlZSA2LjUuMSBieSBAZm9udGF3ZXNvbWUgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbSBMaWNlbnNlIC0gaHR0cHM6Ly9mb250YXdlc29tZS5jb20vbGljZW5zZS9mcmVlIChJY29uczogQ0MgQlkgNC4wLCBGb250czogU0lMIE9GTCAxLjEsIENvZGU6IE1JVCBMaWNlbnNlKSBDb3B5cmlnaHQgMjAyMyBGb250aWNvbnMsIEluYy4tLT48cGF0aCBkPSJNNDM5LjU1IDIzNi4wNSAyNDQgNDAuNDVhMjguODcgMjguODcgMCAwIDAtNDAuODEgMGwtNDAuNjYgNDAuNjMgNTEuNTIgNTEuNTJjMjcuMDYtOS4xNCA1Mi42OCAxNi43NyA0My4zOSA0My42OGw0OS42NiA0OS42NmMzNC4yMy0xMS44IDYxLjE4IDMxIDM1LjQ3IDU2LjY5LTI2LjQ5IDI2LjQ5LTcwLjIxLTIuODctNTYtMzcuMzRMMjQwLjIyIDE5OXYxMjEuODVjMjUuMyAxMi41NCAyMi4yNiA0MS44NSA5LjA4IDU1YTM0LjM0IDM0LjM0IDAgMCAxLTQ4LjU1IDBjLTE3LjU3LTE3LjYtMTEuMDctNDYuOTEgMTEuMjUtNTZ2LTEyM2MtMjAuOC04LjUxLTI0LjYtMzAuNzQtMTguNjQtNDVMMTQyLjU3IDEwMSA4LjQ1IDIzNS4xNGEyOC44NiAyOC44NiAwIDAgMCAwIDQwLjgxbDE5NS42MSAxOTUuNmEyOC44NiAyOC44NiAwIDAgMCA0MC44IDBsMTk0LjY5LTE5NC42OWEyOC44NiAyOC44NiAwIDAgMCAwLTQwLjgxeiIgLz48L3N2Zz4=)
:::

::: md-source__repository
OWASP/Top10
:::
:::::

[[ Home ]{.md-ellipsis}](../index.html){.md-nav__link}

[[ Notice ]{.md-ellipsis}](../0x00-notice/index.html){.md-nav__link}

[[ Introduction
]{.md-ellipsis}](../A00_2021_Introduction/index.html){.md-nav__link}

[[ How to use the OWASP Top 10 as a standard
]{.md-ellipsis}](../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/index.html){.md-nav__link}

[[ How to start an AppSec program with the OWASP Top 10
]{.md-ellipsis}](../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/index.html){.md-nav__link}

[[ About OWASP
]{.md-ellipsis}](../A00-about-owasp/index.html){.md-nav__link}

[ Top 10:2021 List ]{.md-ellipsis} []{.md-nav__icon .md-icon}

[]{.md-nav__icon .md-icon} Top 10:2021 List

[[ A01 Broken Access Control
]{.md-ellipsis}](../A01_2021-Broken_Access_Control/index.html){.md-nav__link}

[[ A02 Cryptographic Failures
]{.md-ellipsis}](../A02_2021-Cryptographic_Failures/index.html){.md-nav__link}

[[ A03 Injection
]{.md-ellipsis}](../A03_2021-Injection/index.html){.md-nav__link}

[[ A04 Insecure Design
]{.md-ellipsis}](../A04_2021-Insecure_Design/index.html){.md-nav__link}

[[ A05 Security Misconfiguration
]{.md-ellipsis}](../A05_2021-Security_Misconfiguration/index.html){.md-nav__link}

[[ A06 Vulnerable and Outdated Components
]{.md-ellipsis}](../A06_2021-Vulnerable_and_Outdated_Components/index.html){.md-nav__link}

[[ A07 Identification and Authentication Failures
]{.md-ellipsis}](../A07_2021-Identification_and_Authentication_Failures/index.html){.md-nav__link}

[ A08 Software and Data Integrity Failures ]{.md-ellipsis}
[]{.md-nav__icon .md-icon} [[ A08 Software and Data Integrity Failures
]{.md-ellipsis}](index.html){.md-nav__link .md-nav__link--active}

[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}

[[ A09 Security Logging and Monitoring Failures
]{.md-ellipsis}](../A09_2021-Security_Logging_and_Monitoring_Failures/index.html){.md-nav__link}

[[ A10 Server Side Request Forgery (SSRF)
]{.md-ellipsis}](../A10_2021-Server-Side_Request_Forgery_(SSRF)/index.html){.md-nav__link}

[[ Next Steps
]{.md-ellipsis}](../A11_2021-Next_Steps/index.html){.md-nav__link}
::::::
:::::::
::::::::

::::: {.md-sidebar .md-sidebar--secondary md-component="sidebar" md-type="toc"}
:::: md-sidebar__scrollwrap
::: md-sidebar__inner
[]{.md-nav__icon .md-icon} Table of contents

- [[ Factors ]{.md-ellipsis}](#factors){.md-nav__link}
- [[ Overview ]{.md-ellipsis}](#overview){.md-nav__link}
- [[ Description ]{.md-ellipsis}](#description){.md-nav__link}
- [[ How to Prevent ]{.md-ellipsis}](#how-to-prevent){.md-nav__link}
- [[ Example Attack Scenarios
  ]{.md-ellipsis}](#example-attack-scenarios){.md-nav__link}
- [[ References ]{.md-ellipsis}](#references){.md-nav__link}
- [[ List of Mapped CWEs
  ]{.md-ellipsis}](#list-of-mapped-cwes){.md-nav__link}
:::
::::
:::::

::: {.md-content md-component="content"}
# A08:2021 -- Software and Data Integrity Failures ![icon](../assets/TOP_10_Icons_Final_Software_and_Data_Integrity_Failures.png){align="right" style="height:80px;width:80px"} {#a082021-software-and-data-integrity-failures}

## Factors

   CWEs Mapped   Max Incidence Rate   Avg Incidence Rate   Avg Weighted Exploit   Avg Weighted Impact   Max Coverage   Avg Coverage   Total Occurrences   Total CVEs
  ------------- -------------------- -------------------- ---------------------- --------------------- -------------- -------------- ------------------- ------------
       10              16.67%               2.05%                  6.94                  7.94              75.04%         45.35%           47,972           1,152

## Overview

A new category for 2021 focuses on making assumptions related to
software updates, critical data, and CI/CD pipelines without verifying
integrity. One of the highest weighted impacts from Common Vulnerability
and Exposures/Common Vulnerability Scoring System (CVE/CVSS) data.
Notable Common Weakness Enumerations (CWEs) include *CWE-829: Inclusion
of Functionality from Untrusted Control Sphere*, *CWE-494: Download of
Code Without Integrity Check*, and *CWE-502: Deserialization of
Untrusted Data*.

## Description

Software and data integrity failures relate to code and infrastructure
that does not protect against integrity violations. An example of this
is where an application relies upon plugins, libraries, or modules from
untrusted sources, repositories, and content delivery networks (CDNs).
An insecure CI/CD pipeline can introduce the potential for unauthorized
access, malicious code, or system compromise. Lastly, many applications
now include auto-update functionality, where updates are downloaded
without sufficient integrity verification and applied to the previously
trusted application. Attackers could potentially upload their own
updates to be distributed and run on all installations. Another example
is where objects or data are encoded or serialized into a structure that
an attacker can see and modify is vulnerable to insecure
deserialization.

## How to Prevent

- Use digital signatures or similar mechanisms to verify the software or
  data is from the expected source and has not been altered.

- Ensure libraries and dependencies, such as npm or Maven, are consuming
  trusted repositories. If you have a higher risk profile, consider
  hosting an internal known-good repository that\'s vetted.

- Ensure that a software supply chain security tool, such as OWASP
  Dependency Check or OWASP CycloneDX, is used to verify that components
  do not contain known vulnerabilities

- Ensure that there is a review process for code and configuration
  changes to minimize the chance that malicious code or configuration
  could be introduced into your software pipeline.

- Ensure that your CI/CD pipeline has proper segregation, configuration,
  and access control to ensure the integrity of the code flowing through
  the build and deploy processes.

- Ensure that unsigned or unencrypted serialized data is not sent to
  untrusted clients without some form of integrity check or digital
  signature to detect tampering or replay of the serialized data

## Example Attack Scenarios

**Scenario #1 Update without signing:** Many home routers, set-top
boxes, device firmware, and others do not verify updates via signed
firmware. Unsigned firmware is a growing target for attackers and is
expected to only get worse. This is a major concern as many times there
is no mechanism to remediate other than to fix in a future version and
wait for previous versions to age out.

**Scenario #2 SolarWinds malicious update**: Nation-states have been
known to attack update mechanisms, with a recent notable attack being
the SolarWinds Orion attack. The company that develops the software had
secure build and update integrity processes. Still, these were able to
be subverted, and for several months, the firm distributed a highly
targeted malicious update to more than 18,000 organizations, of which
around 100 or so were affected. This is one of the most far-reaching and
most significant breaches of this nature in history.

**Scenario #3 Insecure Deserialization:** A React application calls a
set of Spring Boot microservices. Being functional programmers, they
tried to ensure that their code is immutable. The solution they came up
with is serializing the user state and passing it back and forth with
each request. An attacker notices the \"rO0\" Java object signature (in
base64) and uses the Java Serial Killer tool to gain remote code
execution on the application server.

## References

- \[OWASP Cheat Sheet: Software Supply Chain Security\](Coming Soon)

- \[OWASP Cheat Sheet: Secure build and deployment\](Coming Soon)

- [OWASP Cheat Sheet: Infrastructure as
  Code](https://cheatsheetseries.owasp.org/cheatsheets/Infrastructure_as_Code_Security_Cheat_Sheet.html)

- [OWASP Cheat Sheet:
  Deserialization](https://www.owasp.org/index.php/Deserialization_Cheat_Sheet)

- [SAFECode Software Integrity
  Controls](https://safecode.org/publication/SAFECode_Software_Integrity_Controls0610.pdf)

- [A \'Worst Nightmare\' Cyberattack: The Untold Story Of The SolarWinds
  Hack](https://www.npr.org/2021/04/16/985439655/a-worst-nightmare-cyberattack-the-untold-story-of-the-solarwinds-hack)

- [CodeCov Bash Uploader
  Compromise](https://about.codecov.io/security-update)

- [Securing DevOps by Julien
  Vehent](https://www.manning.com/books/securing-devops)

## List of Mapped CWEs

[CWE-345 Insufficient Verification of Data
Authenticity](https://cwe.mitre.org/data/definitions/345.html)

[CWE-353 Missing Support for Integrity
Check](https://cwe.mitre.org/data/definitions/353.html)

[CWE-426 Untrusted Search
Path](https://cwe.mitre.org/data/definitions/426.html)

[CWE-494 Download of Code Without Integrity
Check](https://cwe.mitre.org/data/definitions/494.html)

[CWE-502 Deserialization of Untrusted
Data](https://cwe.mitre.org/data/definitions/502.html)

[CWE-565 Reliance on Cookies without Validation and Integrity
Checking](https://cwe.mitre.org/data/definitions/565.html)

[CWE-784 Reliance on Cookies without Validation and Integrity Checking
in a Security Decision](https://cwe.mitre.org/data/definitions/784.html)

[CWE-829 Inclusion of Functionality from Untrusted Control
Sphere](https://cwe.mitre.org/data/definitions/829.html)

[CWE-830 Inclusion of Web Functionality from an Untrusted
Source](https://cwe.mitre.org/data/definitions/830.html)

[CWE-915 Improperly Controlled Modification of Dynamically-Determined
Object Attributes](https://cwe.mitre.org/data/definitions/915.html)
:::
:::::::::::::
::::::::::::::
